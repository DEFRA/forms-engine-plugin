{% extends "govuk/template.njk" %}

{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "partials/components.html" import componentList with context %}

{% block beforeContent %}
  {% if backLink %}
    {{ govukBackLink(backLink) }}
  {% endif %}
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      {% if previewMode %}
        {% include "partials/preview-banner.html" %}
      {% endif %}

      {% if errors %}
        {{ govukErrorSummary({
          titleText: "There is a problem",
          errorList: checkErrorTemplates(errors)
        }) }}
      {% endif %}

      {% if hasMissingNotificationEmail %}
        {% include "partials/warn-missing-notification-email.html" %}
      {% endif %}

      {% include "partials/heading.html" %}

      {% block form %}
        {% if page.allowContinue %}
          <form method="post" novalidate>
            <input type="hidden" name="crumb" value="{{ crumb }}">

            {% block formComponents %}
              {{ componentList(components) }}
            {% endblock %}

            {% block formButtons %}
              <div class="govuk-button-group">
                {{ govukButton({
                  text: "Start now" if isStartPage else "Continue",
                  isStartButton: isStartPage,
                  preventDoubleClick: true
                }) }}

                {% if allowSaveAndReturn %}
                  {{ govukButton({
                    text: "Save and return",
                    classes: "govuk-button--secondary",
                    name: "action",
                    value: "save-and-return",
                    preventDoubleClick: true
                  }) }}
                {% endif %}
              </div>
            {% endblock %}
          </form>
        {% else %}
          {% block nonFormComponents %}
            {{ componentList(components) }}
          {% endblock %}
        {% endif %}
      {% endblock %}
    </div>
  </div>

  {% if config.cdpEnvironment == 'local' and context | length and not context.isForceAccess %}
    {% include "partials/debug.html" %}
  {% endif %}
{% endblock %}
